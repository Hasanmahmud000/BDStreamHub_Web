<!DOCTYPE html>  
<html lang="en">  
<head>  
  <meta charset="UTF-8" />  
  <meta name="viewport" content="width=device-width, initial-scale=1" />  
  <title>CricStreamZone - Live Matches & Upcoming</title>  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.4/lottie.min.js"></script>  
  <style>  
    .menu-dropdown {  
      position: relative;  
      display: inline-block;  
    }  
    
    .menu-toggle {  
      background: none;  
      border: none;  
      font-size: 22px;  
      color: #0ff;  
      cursor: pointer;  
      padding: 5px;  
      margin-left: 10px;  
    }  
    
    .dropdown-content {  
      display: none;  
      position: absolute;  
      right: 0;  
      top: 30px;  
      background-color: #222;  
      box-shadow: 0 4px 8px rgba(0,0,0,0.7);  
      border-radius: 8px;  
      z-index: 1001;  
      overflow: hidden;  
      min-width: 180px;  
    }  
    
    .dropdown-content a {  
      color: #fff;  
      padding: 10px 16px;  
      display: block;  
      text-decoration: none;  
      font-size: 14px;  
      transition: background 0.3s ease;  
    }  
    
    .dropdown-content a:hover {  
      background-color: #0af;  
    }  
    
    .menu-dropdown:hover .dropdown-content {  
      display: block;  
    }  

    /* Drawer (Side menu) */  
    #drawer {  
      position: fixed;  
      top: 0;  
      left: -600px;  
      width: 320px;  
      height: 100%;  
      background: linear-gradient(135deg, #1a1a2e, #16213e);  
      z-index: 2000;  
      padding: 20px;  
      box-shadow: 2px 0 20px rgba(0, 0, 0, 0.8);  
      transition: left 0.3s ease;  
      overflow-y: auto;  
    }  
    #drawer.open {  
      left: 0;  
    }  
    #drawer h3 {  
      color: #0af;  
      margin-bottom: 20px;  
    }  
    #drawer a {  
      display: block;  
      color: #fff;  
      text-decoration: none;  
      margin-bottom: 12px;  
      padding: 12px 15px;  
      border-radius: 8px;  
      transition: all 0.3s ease;  
      font-weight: 600;  
      background: rgba(255,255,255,0.1);  
      backdrop-filter: blur(10px);  
      border: 1px solid rgba(255,255,255,0.1);  
    }  
    #drawer a:hover {  
      background: #0af;  
      color: #fff;  
      transform: translateX(5px);  
    }  
    #drawerClose {  
      background: none;  
      color: #ccc;  
      border: none;  
      font-size: 22px;  
      position: absolute;  
      top: 10px;  
      right: 15px;  
      cursor: pointer;  
    }  

    /* Live Score Section in Drawer */
    .live-scores {
      background: rgba(0,170,255,0.1);
      border-radius: 10px;
      padding: 15px;
      margin: 15px 0;
      border: 1px solid rgba(0,170,255,0.3);
    }
    .live-scores h4 {
      color: #0af;
      margin: 0 0 10px 0;
      font-size: 16px;
    }
    .score-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .score-item:last-child {
      border-bottom: none;
    }
    .score-teams {
      font-size: 12px;
      color: #ccc;
    }
    .score-value {
      font-size: 12px;
      color: #0f0;
      font-weight: bold;
    }

    /* Language Selector */
    .language-selector {
      margin: 15px 0;
      padding: 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 8px;
    }
    .language-selector select {
      width: 100%;
      padding: 8px;
      background: #333;
      color: #fff;
      border: 1px solid #555;
      border-radius: 5px;
    }

    /* Backdrop overlay */  
    #drawerOverlay {  
      display: none;  
      position: fixed;  
      top: 0;  
      left: 0;  
      height: 100%;  
      width: 100%;  
      background: #00000080;  
      z-index: 1500;  
    }  
    #drawerOverlay.show {  
      display: block;  
    }  

    body {  
      margin: 0;  
      background: linear-gradient(135deg, #0c0c0c, #1a1a1a);  
      color: #fff;  
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;  
    }  
    nav {  
      background: linear-gradient(135deg, #1e1e2e, #2a2a3e);  
      padding: 12px 20px;  
      display: flex;  
      align-items: center;  
      justify-content: space-between;  
      box-shadow: 0 2px 10px rgba(0,0,0,0.5);  
    }  
    .logo {  
      font-size: 20px;  
      font-weight: bold;  
      color: #0ff;  
      text-shadow: 0 0 10px rgba(0,255,255,0.5);  
    }  
    .search-container {  
      flex: 1;  
      display: flex;  
      justify-content: center;  
      position: relative;  
    }  
    .search-container input {  
      border-radius: 25px;  
      padding: 10px 45px 10px 15px;  
      border: 2px solid #333;  
      outline: none;  
      width: 70%;  
      max-width: 300px;  
      background: rgba(255,255,255,0.1);  
      color: #fff;  
      text-align: center;  
      backdrop-filter: blur(10px);  
      transition: all 0.3s ease;  
    }  
    .search-container input:focus {  
      border-color: #0af;  
      box-shadow: 0 0 15px rgba(0,170,255,0.3);  
    }  
    .voice-search-btn {
      position: absolute;
      right: calc(15% + 10px);
      top: 50%;
      transform: translateY(-50%);
      background: #0af;
      border: none;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      color: white;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
    }
    .voice-search-btn:hover {
      background: #08d;
      transform: translateY(-50%) scale(1.1);
    }
    .voice-search-btn.listening {
      background: #f44336;
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0% { transform: translateY(-50%) scale(1); }
      50% { transform: translateY(-50%) scale(1.1); }
      100% { transform: translateY(-50%) scale(1); }
    }

    .notice {  
      background: linear-gradient(45deg, #ff6b35, #f7931e);  
      color: #000;  
      padding: 10px;  
      font-weight: bold;  
      text-align: center;  
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);  
    }  
    
    /* সাব-ট্যাব স্টাইল */  
    .sub-tab-btns {  
      padding: 12px;  
      text-align: center;  
      background: linear-gradient(135deg, #1e1e2e, #2a2a3e);  
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);  
    }  
    .sub-tab-btns button {  
      margin: 0 8px;  
      padding: 10px 18px;  
      border: none;  
      border-radius: 25px;  
      background: rgba(255,255,255,0.1);  
      color: #fff;  
      cursor: pointer;  
      font-weight: 600;  
      font-size: 14px;  
      transition: all 0.3s ease;  
      backdrop-filter: blur(10px);  
      border: 1px solid rgba(255,255,255,0.1);  
    }  
    .sub-tab-btns button:hover {  
      background: #0af;  
      transform: translateY(-2px);  
      box-shadow: 0 5px 15px rgba(0,170,255,0.3);  
    }  
    .sub-tab-btns .active {  
      background: #0af;  
      box-shadow: 0 5px 15px rgba(0,170,255,0.3);  
    }  
    
    /* নিচের বড় ট্যাব স্টাইল */  
    .bottom-tab-btns {  
      position: fixed;  
      bottom: 0;  
      width: 100%;  
      background: linear-gradient(135deg, #1e1e2e, #2a2a3e);  
      display: flex;  
      justify-content: space-around;  
      padding: 12px 0;  
      box-shadow: 0 -4px 15px rgba(0,0,0,0.8);  
      z-index: 1000;  
      backdrop-filter: blur(10px);  
    }  
    .bottom-tab-btns button {  
      background: rgba(255,255,255,0.1);  
      border: 1px solid rgba(255,255,255,0.1);  
      color: #fff;  
      padding: 12px 20px;  
      font-size: 16px;  
      font-weight: 700;  
      border-radius: 15px;  
      cursor: pointer;  
      flex: 1;  
      margin: 0 8px;  
      transition: all 0.3s ease;  
      backdrop-filter: blur(10px);  
    }  
    .bottom-tab-btns button.active {  
      background: #0af;  
      color: #fff;  
      box-shadow: 0 5px 15px rgba(0,170,255,0.3);  
      transform: translateY(-3px);  
    }  
    .bottom-tab-btns button:hover:not(.active) {  
      background: rgba(255,255,255,0.2);  
      transform: translateY(-2px);  
    }  
    
    #match-list {  
      padding: 15px 10px 80px;  
    }  
    
    /* Enhanced Match Card */
    .match {  
      background: linear-gradient(135deg, #1a1a2e, #16213e);  
      border-radius: 15px;  
      padding: 15px;  
      margin-bottom: 15px;  
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);  
      transition: all 0.3s ease;  
      border: 1px solid rgba(255,255,255,0.1);  
      backdrop-filter: blur(10px);  
      position: relative;  
      overflow: hidden;  
    }  
    .match::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #0af, #0f5, #0af);
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .match:hover {  
      box-shadow: 0 8px 25px rgba(0,170,255,0.3);  
      transform: translateY(-5px);  
      border-color: #0af;  
    }  
    .match:hover::before {
      opacity: 1;
    }

    /* Match Header */
    .match-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .match-title {
      font-size: 14px;
      font-weight: 600;
      background: rgba(0,170,255,0.2);
      padding: 6px 12px;
      border-radius: 20px;
      color: #0af;
      border: 1px solid rgba(0,170,255,0.3);
    }
    .favorite-btn {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: #666;
      transition: all 0.3s ease;
    }
    .favorite-btn.active {
      color: #ff6b35;
      transform: scale(1.2);
    }

    /* Teams Section */
    .teams-section {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    .team {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
    }
    .team img {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.2);
      margin-bottom: 8px;
      transition: all 0.3s ease;
    }
    .team:hover img {
      border-color: #0af;
      transform: scale(1.1);
    }
    .team-name {
      font-size: 13px;
      font-weight: bold;
      text-align: center;
      color: #fff;
    }
    .vs-divider {
      font-weight: bold;
      color: #0af;
      font-size: 16px;
      margin: 0 15px;
      text-shadow: 0 0 10px rgba(0,170,255,0.5);
    }

    /* Match Info */
    .match-info {
      text-align: center;
            margin-bottom: 15px;
    }
    .match-time {
      font-size: 13px;
      color: #bbb;
      margin-bottom: 5px;
    }
    .countdown, .started {
      font-size: 14px;
      color: #0f0;
      font-weight: 600;
    }

    /* Server Buttons */
    .server-buttons {
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .server-buttons a {
      background: linear-gradient(45deg, #08f, #0af);
      color: #fff;
      padding: 8px 12px;
      text-decoration: none;
      border-radius: 20px;
      font-weight: 600;
      font-size: 12px;
      transition: all 0.3s ease;
      border: 1px solid rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
    }
    .server-buttons a:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(8,136,255,0.4);
    }

    .liveBlink {  
      display: inline-block;  
      padding: 6px 12px;  
      font-weight: 900;  
      font-size: 10px;  
      color: white;  
      background: linear-gradient(45deg, #ff003c, #ff7700, #ff003c);  
      background-size: 200% 200%;  
      border-radius: 25px;  
      animation: gradientPulse 3s ease infinite, blinkOpacity 1.5s infinite;  
      box-shadow: 0 0 10px #ff003c, 0 0 20px #ff7700;  
      user-select: none;  
      text-transform: uppercase;  
    }  
    @keyframes blinkOpacity {  
      0%, 100% { opacity: 1; }  
      50% { opacity: 0.3; }  
    }  
    @keyframes gradientPulse {  
      0% { background-position: 0% 50%; }  
      50% { background-position: 100% 50%; }  
      100% { background-position: 0% 50%; }  
    }  
    
    /* TV & FM আলাদা সেকশন */  
    #tv-section, #fm-section {  
      padding: 20px;  
      font-size: 16px;  
      color: #ccc;  
      text-align: center;  
    }

    /* Notification System */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(45deg, #0af, #0f5);
      color: white;
      padding: 15px 20px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      z-index: 3000;
      transform: translateX(400px);
      transition: transform 0.3s ease;
      max-width: 300px;
    }
    .notification.show {
      transform: translateX(0);
    }
    .notification .close-btn {
      position: absolute;
      top: 5px;
      right: 10px;
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
    }

    /* Filter Options */
    .filter-section {
      padding: 10px;
      background: rgba(255,255,255,0.05);
      margin: 10px;
      border-radius: 10px;
      display: none;
    }
    .filter-section.show {
      display: block;
    }
    .filter-options {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .filter-btn {
      padding: 6px 12px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      color: #fff;
      border-radius: 15px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s ease;
    }
    .filter-btn.active {
      background: #0af;
      border-color: #0af;
    }

    /* Loading Animation */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 200px;
    }
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(0,170,255,0.3);
      border-top: 4px solid #0af;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .teams-section {
        padding: 0 10px;
      }
      .team img {
        width: 30px;
        height: 30px;
      }
      .server-buttons a {
        padding: 6px 10px;
        font-size: 11px;
      }
      #drawer {
        width: 280px;
      }
    }

    /* Dark/Light Theme Toggle */
    .theme-toggle {
      position: fixed;
      top: 80px;
      right: 20px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      color: #fff;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      cursor: pointer;
      font-size: 20px;
      z-index: 1000;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    .theme-toggle:hover {
      background: #0af;
      transform: scale(1.1);
    }

    /* Social Share Buttons */
    .social-share {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 10px 0;
    }
    .social-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      color: white;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
    }
    .social-btn.facebook { background: #3b5998; }
    .social-btn.twitter { background: #1da1f2; }
    .social-btn.whatsapp { background: #25d366; }
    .social-btn.telegram { background: #0088cc; }
    .social-btn:hover {
      transform: scale(1.1);
    }

    /* Advanced Search */
    .advanced-search {
      display: none;
      background: rgba(255,255,255,0.1);
      padding: 15px;
      margin: 10px;
      border-radius: 10px;
      backdrop-filter: blur(10px);
    }
    .advanced-search.show {
      display: block;
    }
    .search-filters {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .search-filters select,
    .search-filters input {
      padding: 8px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 5px;
      color: #fff;
    }
  </style>  
</head>  
<body>  

<!-- Notification Container -->
<div id="notificationContainer"></div>

<!-- Theme Toggle -->
<button class="theme-toggle" onclick="toggleTheme()" title="Toggle Theme">🌙</button>

<!-- Drawer / Side Menu -->  
<div id="drawer">  
  <button id="drawerClose" onclick="toggleDrawer()">✕</button>  
  
  <!-- Logo Section with Image -->
  <div style="text-align: center; margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px solid #333;">
    <img src="https://i.postimg.cc/3rPWWckN/icon-192.png" alt="CricStreamZone Logo" style="width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px; border: 3px solid #0af;" />
    <div style="color: #0af; font-size: 18px; font-weight: bold;">CricStreamZone</div>
    <div style="color: #888; font-size: 12px;">All Sports Live Streaming</div>
  </div>

  <!-- Language Selector -->
  <div class="language-selector">
    <label style="color: #0af; font-size: 14px; margin-bottom: 5px; display: block;">🌐 Language</label>
    <select id="languageSelect" onchange="changeLanguage(this.value)">
      <option value="en">English</option>
      <option value="bn">বাংলা</option>
      <option value="hi">हिंदी</option>
      <option value="ur">اردو</option>
    </select>
  </div>

  <!-- Live Scores Section -->
  <div class="live-scores">
    <h4>🏏 Live Scores</h4>
    <div id="liveScoresContainer">
      <div class="score-item">
        <div class="score-teams">IND vs AUS</div>
        <div class="score-value">245/4 (45.2)</div>
      </div>
      <div class="score-item">
        <div class="score-teams">ENG vs PAK</div>
        <div class="score-value">189/7 (38.5)</div>
      </div>
    </div>
  </div>
  
  <h3></h3>  
  <a href="https://t.me/CricStreamZone" target="_blank">📣 Join Telegram</a>  
  <a href="https://play.google.com/store/apps/details?id=com.genuine.leone" target="_blank">📲 Download NS Player</a>  
  <a href="#" onclick="showCategory('live'); toggleDrawer();">🏏 Live Matches</a>  
  <a href="#" onclick="showCategory('tv'); toggleDrawer();">📺 Live TV</a>  
  <a href="#" onclick="showCategory('fm'); toggleDrawer();">📻 FM Radio</a>
  <a href="#" onclick="showFavorites(); toggleDrawer();">⭐ Favorites</a>
  <a href="#" onclick="showSettings(); toggleDrawer();">⚙️ Settings</a>
  
  <!-- Social Share in Drawer -->
  <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #333;">
    <h4 style="color: #0af; margin-bottom: 10px;">📤 Share App</h4>
    <div class="social-share">
      <button class="social-btn facebook" onclick="shareApp('facebook')">📘</button>
      <button class="social-btn twitter" onclick="shareApp('twitter')">🐦</button>
      <button class="social-btn whatsapp" onclick="shareApp('whatsapp')">📱</button>
      <button class="social-btn telegram" onclick="shareApp('telegram')">✈️</button>
    </div>
  </div>
</div>  
<div id="drawerOverlay" onclick="toggleDrawer()"></div>

<nav>  
  <div style="display: flex; align-items: center;">
    <button onclick="toggleDrawer()" class="menu-toggle">☰</button>
    <div class="logo">CricStreamZone</div>
  </div>
  <div class="search-container">  
    <input id="search" type="text" placeholder="Search matches or teams" />  
    <button class="voice-search-btn" onclick="startVoiceSearch()" title="Voice Search">🎤</button>
  </div>
  <button onclick="toggleAdvancedSearch()" style="background: none; border: none; color: #0af; font-size: 18px; cursor: pointer; margin-left: 10px;" title="Advanced Search">🔍</button>
</nav>  

<!-- Advanced Search Section -->
<div id="advancedSearch" class="advanced-search">
  <h4 style="color: #0af; margin-bottom: 10px;">🔍 Advanced Search & Filters</h4>
  <div class="search-filters">
    <select id="teamFilter">
      <option value="">All Teams</option>
      <option value="india">India</option>
      <option value="australia">Australia</option>
      <option value="england">England</option>
      <option value="pakistan">Pakistan</option>
    </select>
    <select id="formatFilter">
      <option value="">All Formats</option>
      <option value="test">Test</option>
      <option value="odi">ODI</option>
      <option value="t20">T20</option>
    </select>
    <input type="date" id="dateFilter" />
    <button onclick="applyFilters()" style="background: #0af; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">Apply</button>
  </div>
</div>

<!-- Filter Section -->
<div id="filterSection" class="filter-section">
  <div class="filter-options">
    <button class="filter-btn active" data-filter="all">All</button>
    <button class="filter-btn" data-filter="cricket">Cricket</button>
    <button class="filter-btn" data-filter="football">Football</button>
    <button class="filter-btn" data-filter="tennis">Tennis</button>
    <button class="filter-btn" data-filter="basketball">Basketball</button>
  </div>
</div>
  
<div class="notice">  
  <marquee scrollamount="5">Welcome To CricStreamZone ! ⚠️ Attention All Users ! For flawless live sports streaming on your mobile device ! please install the NS Player app now ! Without NS Player, videos may not play properly or could stop unexpectedly ! 📲 Don't miss a single moment — install NS Player today and enjoy uninterrupted live matches ! You can download the app from:  
Google Play Store or join our Telegram channel for the latest updates and app links:CricStreamZone Telegram ! </marquee>  
</div>  
  
<!-- সাব-ট্যাব শুধুমাত্র Live Category তে দেখাবে -->  
<div id="subTabs" class="sub-tab-btns" style="display:none;">  
  <button id="subLive" class="active">Live <span id="countLive"></span></button>  
  <button id="subToday">Today <span id="countToday"></span></button>  
  <button id="subUpcoming">Upcoming <span id="countUpcoming"></span></button>
  <button onclick="toggleFilterSection()" style="background: rgba(255,255,255,0.1); margin-left: 10px;">🔽 Filter</button>
</div>  
  
<div id="match-list"></div>  
  
<!-- TV এবং FM সেকশন -->  
<div id="tv-section" style="display:none;">  
  <h2>📺 Live TV Channels</h2>  
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; padding: 20px;">
    <div style="background: linear-gradient(135deg, #1a1a2e, #16213e); padding: 20px; border-radius: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
      <h3 style="color: #0af;">Sports Channels</h3>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">Star Sports 1</a>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">Sony Sports</a>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">ESPN</a>
    </div>
    <div style="background: linear-gradient(135deg, #1a1a2e, #16213e); padding: 20px; border-radius: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
      <h3 style="color: #0af;">News Channels</h3>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">BBC News</a>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">CNN</a>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">Al Jazeera</a>
    </div>
  </div>
</div>  
  
<div id="fm-section" style="display:none;">  
  <h2>📻 FM Radio Stations</h2>  
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; padding: 20px;">
    <div style="background: linear-gradient(135deg, #1a1a2e, #16213e); padding: 20px; border-radius: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
      <h3 style="color: #0af;">Music Stations</h3>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">Radio Mirchi</a>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">Red FM</a>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">Big FM</a>
    </div>
    <div style="background: linear-gradient(135deg, #1a1a2e, #16213e); padding: 20px; border-radius: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
      <h3 style="color: #0af;">Sports Radio</h3>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">ESPN Radio</a>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">Sports Radio</a>
      <a href="#" style="display: block; margin: 10px 0; padding: 10px; background: #0af; color: white; text-decoration: none; border-radius: 8px;">Talk Sport</a>
    </div>
  </div>
</div>

<!-- Favorites Section -->
<div id="favorites-section" style="display:none;">
  <h2>⭐ Your Favorite Matches</h2>
  <div id="favoritesList" style="padding: 20px;">
    <!-- Favorite matches will be loaded here -->
  </div>
</div>

<!-- Settings Section -->
<div id="settings-section" style="display:none;">
  <div style="padding: 20px; max-width: 500px; margin: 0 auto;">
    <h2>⚙️ Settings</h2>
    
    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin: 15px 0;">
      <h3 style="color: #0af;">🔔 Notifications</h3>
      <label style="display: flex; align-items: center; margin: 10px 0;">
        <input type="checkbox" id="matchStartNotif" checked style="margin-right: 10px;">
        Match Start Notifications
      </label>
      <label style="display: flex; align-items: center; margin: 10px 0;">
        <input type="checkbox" id="scoreUpdateNotif" checked style="margin-right: 10px;">
        Score Update Notifications
      </label>
      <label style="display: flex; align-items: center; margin: 10px 0;">
        <input type="checkbox" id="favoriteTeamNotif" checked style="margin-right: 10px;">
        Favorite Team Notifications
      </label>
    </div>

    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin: 15px 0;">
      <h3 style="color: #0af;">🎨 Appearance</h3>
      <label style="display: flex; align-items: center; margin: 10px 0;">
        <input type="checkbox" id="darkMode" checked style="margin-right: 10px;">
        Dark Mode
      </label>
      <label style="display: block; margin: 10px 0;">
        Theme Color:
        <select id="themeColor" style="margin-left: 10px; padding: 5px; background: #333; color: white; border: 1px solid #555; border-radius: 5px;">
          <option value="blue">Blue</option>
          <option value="green">Green</option>
          <option value="purple">Purple</option>
          <option value="orange">Orange</option>
        </select>
      </label>
    </div>

    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin: 15px 0;">
      <h3 style="color: #0af;">📱 App Settings</h3>
      <label style="display: flex; align-items: center; margin: 10px 0;">
        <input type="checkbox" id="autoRefresh" checked style="margin-right: 10px;">
        Auto Refresh Matches
      </label>
      <label style="display: block; margin: 10px 0;">
        Refresh Interval:
        <select id="refreshInterval" style="margin-left: 10px; padding: 5px; background: #333; color: white; border: 1px solid #555; border-radius: 5px;">
          <option value="30">30 seconds</option>
          <option value="60" selected>1 minute</option>
          <option value="120">2 minutes</option>
          <option value="300">5 minutes</option>
        </select>
      </label>
    </div>

    <button onclick="saveSettings()" style="background: #0af; color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 20px;">Save Settings</button>
  </div>
</div>
  
<!-- নিচের বড় ৩টা ট্যাব -->  
<div class="bottom-tab-btns">  
  <button id="bottomLive" class="active">  
    <img src="https://i.postimg.cc/BvWg87Rd/videocam-24dp-E3-E3-E3-FILL0-wght400-GRAD0-opsz24.png" alt="Live Icon" style="vertical-align: middle; margin-right: 6px;" />  
    Live  
  </button>  
  <button id="bottomTV">  
    <img src="https://i.postimg.cc/K8JDvvxs/live-tv-24dp-E3-E3-E3-FILL0-wght400-GRAD0-opsz24.png" alt="TV Icon" style="vertical-align: middle; margin-right: 6px;" />  
    TV  
  </button>  
  <button id="bottomFM">  
    <img src="https://i.postimg.cc/YC472jwd/radio-24dp-E3-E3-E3-FILL0-wght400-GRAD0-opsz24.png" alt="FM Icon" style="vertical-align: middle; margin-right: 6px;" />  
    FM  
  </button>  
</div>  

<!-- Telegram Join Popup -->  
<div id="telegramPopup" style="display:none;">  
  <div style="position:fixed; top:0; left:0; width:100%; height:100%; background:#000000aa; z-index:9999; display:flex; align-items:center; justify-content:center;">  
    <div style="background: linear-gradient(135deg, #1a1a2e, #16213e); padding:25px; border-radius:15px; max-width:90%; width:360px; text-align:center; box-shadow:0 10px 30px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.1);">  
      <h3 style="color:#0af; margin-bottom:15px;">📣 Join Our Telegram</h3>  
      <p style="color:#ccc; font-size:14px; line-height: 1.5;">🔔 For live match updates, instant scores, and exclusive stream links — Join our official Telegram channel now! 📲 Download the NS Player app for smooth, uninterrupted streaming.</p>  
      <div style="margin-top:20px;">  
        <a href="https://t.me/CricStreamZone" target="_blank" style="background: linear-gradient(45deg, #08f, #0af); color:#fff; padding:12px 25px; text-decoration:none; border-radius:25px; display:inline-block; font-weight:600; margin-right: 10px;">Join Now</a>  
        <button onclick="closeTelegramPopup()" style="background:#444; color:#ccc; padding:12px 25px; border:none; border-radius:25px; cursor:pointer;">Later</button>  
      </div>  
    </div>  
  </div>  
</div>

<script>  
  // Global Variables
  let matches = [];  
  let intervals = [];  
  let currentSubTab = 'live';
  let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
  let currentLanguage = localStorage.getItem('language') || 'en';
  let currentTheme = localStorage.getItem('theme') || 'dark';
  let settings = JSON.parse(localStorage.getItem('settings')) || {
    matchStartNotif: true,
    scoreUpdateNotif: true,
    favoriteTeamNotif: true,
    darkMode: true,
    themeColor: 'blue',
    autoRefresh: true,
    refreshInterval: 60
  };

  // Language Translations
  const translations = {
    en: {
      welcome: "Welcome To CricStreamZone",
      liveMatches: "Live Matches",
      todayMatches: "Today Matches", 
      upcomingMatches: "Upcoming Matches",
      noMatches: "No matches available",
      searchPlaceholder: "Search matches or teams",
      joinTelegram: "Join Telegram",
      downloadApp: "Download NS Player"
    },
    bn: {
      welcome: "CricStreamZone এ স্বাগতম",
      liveMatches: "লাইভ ম্যাচ",
      todayMatches: "আজকের ম্যাচ",
      upcomingMatches: "আসন্ন ম্যাচ", 
      noMatches: "কোন ম্যাচ নেই",
      searchPlaceholder: "ম্যাচ বা টিম খুঁজুন",
      joinTelegram: "টেলিগ্রামে যোগ দিন",
      downloadApp: "NS Player ডাউনলোড করুন"
    },
    hi: {
      welcome: "CricStreamZone में आपका स्वागत है",
      liveMatches: "लाइव मैच",
      todayMatches: "आज के मैच",
      upcomingMatches: "आगामी मैच",
      noMatches: "कोई मैच उपलब्ध नहीं",
      searchPlaceholder: "मैच या टीम खोजें",
      joinTelegram: "टेलीग्राम ज्वाइन करें", 
      downloadApp: "NS Player डाउनलोड करें"
    },
    ur: {
      welcome: "CricStreamZone میں خوش آمدید",
      liveMatches: "لائیو میچز",
      todayMatches: "آج کے میچز",
      upcomingMatches: "آنے والے میچز",
      noMatches: "کوئی میچ دستیاب نہیں",
      searchPlaceholder: "میچ یا ٹیم تلاش کریں",
      joinTelegram: "ٹیلیگرام جوائن کریں",
      downloadApp: "NS Player ڈاؤن لوڈ کریں"
    }
  };

  // API URL
  const matchesApi = "https://script.google.com/macros/s/AKfycbxzx4xcwEGidoxEd7BQshkR9FKHjK5o0p8ukNY4NsKNR0EsShY7eV3MUxA2iXz1V8bmHg/exec";  

  // Utility Functions
  function clearIntervals() {  
    intervals.forEach(i => clearInterval(i));  
    intervals = [];  
  }  
  
  function getNow() { return new Date(); }  
  function getCountdown(t) { return Math.max(0, new Date(t) - getNow()); }  
  function formatCountdown(ms) {  
    let s = Math.floor(ms / 1000), m = Math.floor(s / 60), h = Math.floor(m / 60), d = Math.floor(h / 24);  
    h %= 24; m %= 60; s %= 60;  
    return `${d}d ${h}h ${m}m ${s}s left`;  
  }  
  function formatCountUp(ms) {  
    let s = Math.floor(ms / 1000), m = Math.floor(s / 60), h = Math.floor(m / 60);  
    s %= 60; m %= 60;  
    return `${h > 0 ? h + 'h ' : ''}${m}m ${s}s ago`;  
  }

  // Drawer Functions
  function toggleDrawer() {  
    const drawer = document.getElementById('drawer');  
    const overlay = document.getElementById('drawerOverlay');  
    drawer.classList.toggle('open');  
    overlay.classList.toggle('show');  
  }

  // Notification System
  function showNotification(message, type = 'info', duration = 5000) {
    const container = document.getElementById('notificationContainer');
    const notification = document.createElement('div');
    notification.className = 'notification show';
    notification.innerHTML = `
      <button class="close-btn" onclick="this.parentElement.remove()">×</button>
      <div>${message}</div>
    `;
    
    container.appendChild(notification);
    
    setTimeout(() => {
      notification.classList.remove('show');
      setTimeout(() => notification.remove(), 300);
    }, duration);
  }

  // Voice Search Function
  function startVoiceSearch() {
    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
      showNotification('Voice search not supported in this browser', 'error');
      return;
    }

    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    const voiceBtn = document.querySelector('.voice-search-btn');
    
    recognition.lang = currentLanguage === 'bn' ? 'bn-BD' : currentLanguage === 'hi' ? 'hi-IN' : 'en-US';
    recognition.continuous = false;
    recognition.interimResults = false;

    voiceBtn.classList.add('listening');
    
    recognition.onresult = function(event) {
      const transcript = event.results[0][0].transcript;
      document.getElementById('search').value = transcript;
      renderMatches(currentSubTab);
      showNotification(`Searching for: ${transcript}`, 'success');
    };

    recognition.onerror = function(event) {
      showNotification('Voice search error. Please try again.', 'error');
    };

    recognition.onend = function() {
      voiceBtn.classList.remove('listening');
    };

    recognition.start();
  }

  // Advanced Search Functions
  function toggleAdvancedSearch() {
    const advancedSearch = document.getElementById('advancedSearch');
    advancedSearch.classList.toggle('show');
  }

  function applyFilters() {
    const teamFilter = document.getElementById('teamFilter').value;
    const formatFilter = document.getElementById('formatFilter').value;
    const dateFilter = document.getElementById('dateFilter').value;
    
    // Apply filters logic here
    renderMatches(currentSubTab);
    showNotification('Filters applied successfully', 'success');
  }

  function toggleFilterSection() {
    const filterSection = document.getElementById('filterSection');
    filterSection.classList.toggle('show');
  }

  // Filter button handlers
  document.addEventListener('DOMContentLoaded', function() {
    const filterBtns = document.querySelectorAll('.filter-btn');
    filterBtns.forEach(btn => {
      btn.addEventListener('click', function() {
        filterBtns.forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        renderMatches(currentSubTab);
      });
    });
  });

  // Favorite System
  function toggleFavorite(matchId) {
    const index = favorites.indexOf(matchId);
    if (index > -1) {
      favorites.splice(index, 1);
      showNotification('Removed from favorites', 'info');
    } else {
      favorites.push(matchId);
      showNotification('Added to favorites', 'success');
    }
    localStorage.setItem('favorites', JSON.stringify(favorites));
    
    // Update favorite button
    const btn = document.querySelector(`[data-match-id="${matchId}"]`);
    if (btn) {
      btn.classList.toggle('active');
    }
  }

  function showFavorites() {
    hideAllSections();
    document.getElementById('favorites-section').style.display = 'block';
    
    const favoriteMatches = matches.filter(m => favorites.includes(m.id));
    const container = document.getElementById('favoritesList');
    
    if (favoriteMatches.length === 0) {
      container.innerHTML = `
        <div style="text-align: center; padding: 50px; color: #666;">
          <h3>No favorite matches yet</h3>
          <p>Add matches to favorites by clicking the ⭐ icon</p>
        </div>
      `;
    } else {
      container.innerHTML = '';
      favoriteMatches.forEach(match => {
        // Render favorite matches (similar to renderMatches but for favorites)
      });
    }
  }

  // Settings Functions
  function showSettings() {
    hideAllSections();
    document.getElementById('settings-section').style.display = 'block';
    loadSettings();
  }

  function loadSettings() {
    document.getElementById('matchStartNotif').checked = settings.matchStartNotif;
    document.getElementById('scoreUpdateNotif').checked = settings.scoreUpdateNotif;
    document.getElementById('favoriteTeamNotif').checked = settings.favoriteTeamNotif;
    document.getElementById('darkMode').checked = settings.darkMode;
    document.getElementById('themeColor').value = settings.themeColor;
    document.getElementById('autoRefresh').checked = settings.autoRefresh;
    document.getElementById('refreshInterval').value = settings.refreshInterval;
  }

  function saveSettings() {
    settings = {
      matchStartNotif: document.getElementById('matchStartNotif').checked,
      scoreUpdateNotif: document.getElementById('scoreUpdateNotif').checked,
      favoriteTeamNotif: document.getElementById('favoriteTeamNotif').checked,
      darkMode: document.getElementById('darkMode').checked,
      themeColor: document.getElementById('themeColor').value,
      autoRefresh: document.getElementById('autoRefresh').checked,
      refreshInterval: parseInt(document.getElementById('refreshInterval').value)
    };
    
    localStorage.setItem('settings', JSON.stringify(settings));
    applyTheme();
    showNotification('Settings saved successfully', 'success');
  }

  // Theme Functions
  function toggleTheme() {
    currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
    localStorage.setItem('theme', currentTheme);
    applyTheme();
  }

  function applyTheme() {
    const root = document.documentElement;
    if (currentTheme === 'light') {
      root.style.setProperty('--bg-primary', '#f5f5f5');
      root.style.setProperty('--bg-secondary', '#ffffff');
      root.style.setProperty('--text-primary', '#333333');
      root.style.setProperty('--text-secondary', '#666666');
    } else {
      root.style.setProperty('--bg-primary', '#111111');
      root.style.setProperty('--bg-secondary', '#222222');
      root.style.setProperty('--text-primary', '#ffffff');
      root.style.setProperty('--text-secondary', '#cccccc');
    }
  }

  // Language Functions
  function changeLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    updateLanguage();
    showNotification('Language changed successfully', 'success');
  }

  function updateLanguage() {
    const t = translations[currentLanguage];
    // Update UI text based on selected language
    document.querySelector('.notice marquee').innerHTML = t.welcome + ' ! ⚠️ Attention All Users ! For flawless live sports streaming on your mobile device ! please install the NS Player app now !';
    document.getElementById('search').placeholder = t.searchPlaceholder;
  }

  // Social Share Functions
  function shareApp(platform) {
    const url = window.location.href;
    const text = 'Check out CricStreamZone for live cricket streaming!';
    
    let shareUrl = '';
    switch(platform) {
      case 'facebook':
        shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
        break;
      case 'twitter':
        shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
        break;
      case 'whatsapp':
        shareUrl = `https://wa.me/?text=${encodeURIComponent(text + ' ' + url)}`;
        break;
      case 'telegram':
        shareUrl = `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`;
        break;
    }
    
    if (shareUrl) {
      window.open(shareUrl, '_blank', 'width=600,height=400');
    }
  }

  // Hide all sections
  function hideAllSections() {
    document.getElementById('subTabs').style.display = 'none';
    document.getElementById('match-list').style.display = 'none';
    document.getElementById('tv-section').style.display = 'none';
    document.getElementById('fm-section').style.display = 'none';
    document.getElementById('favorites-section').style.display = 'none';
    document.getElementById('settings-section').style.display = 'none';
  }

  // Enhanced Match Rendering
  function renderMatches(type = 'live') {  
    clearIntervals();  
    const now = getNow();  
    const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());  
    const todayEnd = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);  
    
    const list = document.getElementById('match-list');  
    list.innerHTML = '<div class="loading"><div class="loading-spinner"></div></div>';
    
    setTimeout(() => {
      const filter = document.getElementById('search').value.toLowerCase();  
      const activeFilter = document.querySelector('.filter-btn.active')?.dataset.filter || 'all';
      
      let filteredMatches = matches.filter(m => {  
        const ct = new Date(m.MatchTime);  
        const isLive = now >= ct;  
        
        if (type === 'live' && !isLive) return false;  
        else if (type === 'today') {  
          if (ct < todayStart || ct >= todayEnd || isLive) return false;  
        }  
        else if (type === 'upcoming') {  
          if (ct < now || (ct >= todayStart && ct < todayEnd)) return false;  
        }  
        
        if (filter && !(m.Match.toLowerCase().includes(filter) || m.Team1.toLowerCase().includes(filter) || m.Team2.toLowerCase().includes(filter))) return false;  
        
        if (activeFilter !== 'all' && !m.Match.toLowerCase().includes(activeFilter)) return false;
        
        return true;  
      });  
      
      filteredMatches.sort((a, b) => new Date(a.MatchTime) - new Date(b.MatchTime));  
      
      list.innerHTML = "";
      
      if (filteredMatches.length === 0) {  
        let emojiMessage = '😴 No matches available right now.';  
        if (type === 'live') emojiMessage = '📴 No live matches at the moment.';  
        else if (type === 'upcoming') emojiMessage = '🕒 No upcoming matches found.';  
        else if (type === 'today') emojiMessage = '📅 No matches scheduled for today.';  
        
        list.innerHTML = `  
          <div style="max-width: 420px; margin: 40px auto; padding: 30px 20px; background: linear-gradient(135deg, #1a1a2e, #16213e); border-radius: 15px; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3); color: #ccc; font-family: 'Segoe UI', sans-serif; font-size: 1.25rem; font-weight: 500; text-align: center; user-select: none; display: flex; align-items: center; justify-content: center; gap: 14px; border: 1px solid rgba(255,255,255,0.1);">  
            <span style="font-size: 2.5rem;">${emojiMessage.match(/^(\p{Emoji_Presentation}|\p{Extended_Pictographic})+/u)[0]}</span>  
            <span>${emojiMessage.replace(/^(\p{Emoji_Presentation}|\p{Extended_Pictographic})+\s*/, '')}</span>  
          </div>  
        `;  
        return;  
      }  
      
      filteredMatches.forEach((m, i) => {  
        const ct = new Date(m.MatchTime);  
        const isLive = now >= ct;  
        const isFavorite = favorites.includes(m.id);
        
        const div = document.createElement('div');  
        div.className = "match";  
        
        let timerHtml = '';  
        if (isLive) {  
          const diffLive = getNow() - ct;  
          timerHtml = `  
            <div style="text-align: center; margin: 10px 0;">  
              <div id="liveAnim${i}" style="width: 50px; height: 50px; margin: 0 auto;"></div>  
              <div class="countdown" id="cd${type}${i}">Started ${formatCountUp(diffLive)}</div>  
            </div>  
          `;  
        } else {  
          const dateStr = ct.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });  
          const timeStr = ct.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });  
          timerHtml = `  
            <div class="match-time">${dateStr}</div>  
            <div class="match-time">${timeStr}</div>  
            <div class="countdown" id="cd${type}${i}">⏳ ${formatCountdown(getCountdown(m.MatchTime))}</div>  
            ${getCountdown(m.MatchTime) <= 15 * 60 * 1000 ? `<div style="color: #ff6b35; font-weight: bold; animation: pulse 2s infinite;">⏳ Starting Soon...</div>` : ''}  
          `;  
        }  
        
        div.innerHTML = `
          <div class="match-header">
            <div class="match-title">${m.Match}</div>
            <button class="favorite-btn ${isFavorite ? 'active' : ''}" onclick="toggleFavorite('${m.id}')" data-match-id="${m.id}">
              ${isFavorite ? '⭐' : '☆'}            </button>
          </div>

          <div class="teams-section">
            <div class="team">
              <img src="${m.Team1Logo}" alt="${m.Team1} logo" loading="lazy" />
              <div class="team-name">${m.Team1}</div>
            </div>
            <div class="vs-divider">VS</div>
            <div class="team">
              <img src="${m.Team2Logo}" alt="${m.Team2} logo" loading="lazy" />
              <div class="team-name">${m.Team2}</div>
            </div>
          </div>

          <div class="match-info">
            ${timerHtml}
          </div>

          <div class="server-buttons">
            ${m.servers && m.servers.length > 0 ? 
              m.servers.map((server, index) => {
                const colors = ['#00bcd4', '#009688', '#3f51b5', '#ff5722', '#9c27b0', '#4caf50', '#ff9800'];
                const bgColor = colors[index % colors.length];
                return `<a href="${server.link}" target="_blank" rel="noopener noreferrer" style="background:${bgColor};">${server.name}</a>`;
              }).join('') 
              : '<span style="color:#888; font-size:12px;">No servers available</span>'
            }
          </div>
        `;
        
        list.appendChild(div);  
        
        // Lottie animation for live matches
        if (isLive) {  
          setTimeout(() => {  
            bodymovin.loadAnimation({  
              container: document.getElementById('liveAnim' + i),  
              renderer: 'svg',  
              loop: true,  
              autoplay: true,  
              path: 'https://raw.githubusercontent.com/Hasanmahmud000/HasanTv/refs/heads/main/live-icon.json'  
            });  
          }, 0);  
        }  
        
        // Timer intervals
        if (!isLive) {  
          intervals.push(setInterval(() => {  
            const cdEl = div.querySelector(`#cd${type}${i}`);  
            if (cdEl) {  
              const remain = getCountdown(m.MatchTime);  
              cdEl.innerText = remain > 0 ? `⏳ ${formatCountdown(remain)}` : "Starting soon";  
              
              // Notification for match starting soon
              if (remain <= 5 * 60 * 1000 && remain > 4 * 60 * 1000 && settings.matchStartNotif) {
                showNotification(`${m.Team1} vs ${m.Team2} starting in 5 minutes!`, 'info');
              }
            }  
          }, 1000));  
        } else {  
          intervals.push(setInterval(() => {  
            const cdEl = div.querySelector(`#cd${type}${i}`);  
            if (cdEl) {  
              const diffLive = getNow() - ct;  
              cdEl.innerText = `Started ${formatCountUp(diffLive)}`;  
            }  
          }, 1000));  
        }  
      });
    }, 500);
  }  
  
  // Category Management
  function showCategory(category) {  
    // Update bottom tab active state
    document.getElementById('bottomLive').classList.remove('active');  
    document.getElementById('bottomTV').classList.remove('active');  
    document.getElementById('bottomFM').classList.remove('active');  
    document.getElementById('bottom' + category.charAt(0).toUpperCase() + category.slice(1)).classList.add('active');  
    
    // Clear search
    document.getElementById('search').value = '';  
    
    // Hide all sections
    hideAllSections();
    
    if(category === 'live') {  
      document.getElementById('subTabs').style.display = 'block';  
      document.getElementById('match-list').style.display = 'block';  
      currentSubTab = 'live';  
      setActiveSubTab(currentSubTab);  
      renderMatches(currentSubTab);  
    } else if(category === 'tv') {  
      document.getElementById('tv-section').style.display = 'block';  
    } else if(category === 'fm') {  
      document.getElementById('fm-section').style.display = 'block';  
    }  
  }  
  
  // Sub-tab Management
  function setActiveSubTab(subTab) {  
    document.getElementById('subLive').classList.remove('active');  
    document.getElementById('subToday').classList.remove('active');   
    document.getElementById('subUpcoming').classList.remove('active');  
    document.getElementById('sub' + subTab.charAt(0).toUpperCase() + subTab.slice(1)).classList.add('active');  
  }  

  // Event Listeners
  document.getElementById('bottomLive').addEventListener('click', () => showCategory('live'));  
  document.getElementById('bottomTV').addEventListener('click', () => showCategory('tv'));  
  document.getElementById('bottomFM').addEventListener('click', () => showCategory('fm'));  
  
  // Sub Tab Events
  document.getElementById('subLive').addEventListener('click', () => {  
    currentSubTab = 'live';  
    setActiveSubTab(currentSubTab);  
    renderMatches(currentSubTab);  
  });  
  
  document.getElementById('subToday').addEventListener('click', () => {  
    currentSubTab = 'today';  
    setActiveSubTab(currentSubTab);  
    renderMatches(currentSubTab);  
  });
  
  document.getElementById('subUpcoming').addEventListener('click', () => {  
    currentSubTab = 'upcoming';  
    setActiveSubTab(currentSubTab);  
    renderMatches(currentSubTab);  
  });  
  
  // Search Event
  document.getElementById('search').addEventListener('input', () => {  
    if(document.getElementById('subTabs').style.display === 'block'){  
      renderMatches(currentSubTab);  
    }  
  });

  // Live Score Updates
  function updateLiveScores() {
    const liveScoresContainer = document.getElementById('liveScoresContainer');
    const liveMatches = matches.filter(m => new Date(m.MatchTime) <= new Date()).slice(0, 3);
    
    if (liveMatches.length > 0) {
      liveScoresContainer.innerHTML = liveMatches.map(match => `
        <div class="score-item">
          <div class="score-teams">${match.Team1} vs ${match.Team2}</div>
          <div class="score-value">${match.score || 'Live'}</div>
        </div>
      `).join('');
    }
  }

  // Auto Refresh Function
  function startAutoRefresh() {
    if (settings.autoRefresh) {
      setInterval(() => {
        if (document.getElementById('match-list').style.display !== 'none') {
          fetchMatches();
        }
        updateLiveScores();
      }, settings.refreshInterval * 1000);
    }
  }

  // Fetch Matches Function
  function fetchMatches() {
    fetch(matchesApi)
    .then(res => res.json())
    .then(data => {
      matches = data.matches || [];
      
      // Add unique IDs if not present
      matches = matches.map((match, index) => ({
        ...match,
        id: match.id || `match_${index}_${Date.now()}`
      }));

      const now = new Date();
      const todayStart = new Date(now.getFullYear(), now.getMonth(), now.getDate());
      const todayEnd = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);

      // Count matches for each category
      const liveCount = matches.filter(m => new Date(m.MatchTime) <= now).length;
      const todayCount = matches.filter(m => {
        const ct = new Date(m.MatchTime);
        return ct >= todayStart && ct < todayEnd && ct > now;
      }).length;
      const upcomingCount = matches.filter(m => new Date(m.MatchTime) > todayEnd).length;

      // Update UI counters
      document.getElementById("countLive").innerText = `(${liveCount})`;
      document.getElementById("countToday").innerText = `(${todayCount})`;
      document.getElementById("countUpcoming").innerText = `(${upcomingCount})`;

      // Sort matches
      const todayMatches = matches.filter(m => {
        const ct = new Date(m.MatchTime);
        return ct >= todayStart && ct < todayEnd && ct > now;
      });

      const upcomingMatches = matches.filter(m => {
        const ct = new Date(m.MatchTime);
        return ct > todayEnd;
      });

      const liveMatches = matches.filter(m => new Date(m.MatchTime) <= now);

      matches = [
        ...liveMatches.map(m => ({ ...m, isLive: true })),
        ...todayMatches.map(m => ({ ...m, isToday: true })),
        ...upcomingMatches.map(m => ({ ...m, isUpcoming: true })),
      ];

      // Update live scores
      updateLiveScores();
      
      // Re-render if on live category
      if (document.getElementById('match-list').style.display !== 'none') {
        renderMatches(currentSubTab);
      }
    })
    .catch(e => {
      console.error('Error fetching matches:', e);
      showNotification('Failed to load match data. Please check your connection.', 'error');
    });
  }

  // Telegram Popup Functions
  function closeTelegramPopup() {  
    document.getElementById('telegramPopup').style.display = 'none';  
    localStorage.setItem('hideTelegramPopup', 'true');  
  }  
  
  // Touch/Swipe functionality for sub-tabs
  let touchStartX = 0;
  let touchEndX = 0;
  let touchStartY = 0;
  let touchEndY = 0;

  function handleSwipe() {
    const deltaX = touchEndX - touchStartX;
    const deltaY = touchEndY - touchStartY;
    
    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
      if (document.getElementById('subTabs').style.display === 'block') {
        const subTabs = ['live', 'today', 'upcoming'];
        const currentIndex = subTabs.indexOf(currentSubTab);
        
        if (deltaX > 0) {
          if (currentIndex > 0) {
            const newTab = subTabs[currentIndex - 1];
            currentSubTab = newTab;
            setActiveSubTab(currentSubTab);
            renderMatches(currentSubTab);
          }
        } else {
          if (currentIndex < subTabs.length - 1) {
            const newTab = subTabs[currentIndex + 1];
            currentSubTab = newTab;
            setActiveSubTab(currentSubTab);
            renderMatches(currentSubTab);
          }
        }
      }
    }
  }

  // Touch Events
  document.addEventListener('touchstart', function(e) {
    touchStartX = e.changedTouches[0].screenX;
    touchStartY = e.changedTouches[0].screenY;
  }, { passive: true });

  document.addEventListener('touchend', function(e) {
    touchEndX = e.changedTouches[0].screenX;
    touchEndY = e.changedTouches[0].screenY;
    handleSwipe();
  }, { passive: true });

  // Mouse Events for Desktop
  let mouseStartX = 0;
  let mouseStartY = 0;
  let isMouseDown = false;

  document.addEventListener('mousedown', function(e) {
    mouseStartX = e.clientX;
    mouseStartY = e.clientY;
    isMouseDown = true;
  });

  document.addEventListener('mouseup', function(e) {
    if (isMouseDown) {
      const deltaX = e.clientX - mouseStartX;
      const deltaY = e.clientY - mouseStartY;
      
      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
        if (document.getElementById('subTabs').style.display === 'block') {
          const subTabs = ['live', 'today', 'upcoming'];
          const currentIndex = subTabs.indexOf(currentSubTab);
          
          if (deltaX > 0) {
            if (currentIndex > 0) {
              const newTab = subTabs[currentIndex - 1];
              currentSubTab = newTab;
              setActiveSubTab(currentSubTab);
              renderMatches(currentSubTab);
            }
          } else {
            if (currentIndex < subTabs.length - 1) {
              const newTab = subTabs[currentIndex + 1];
              currentSubTab = newTab;
              setActiveSubTab(currentSubTab);
              renderMatches(currentSubTab);
            }
          }
        }
      }
      isMouseDown = false;
    }
  });

  document.addEventListener('mouseleave', function() {
    isMouseDown = false;
  });

  // Service Worker for PWA
  if ('serviceWorker' in navigator) {  
    navigator.serviceWorker.register('sw.js').then(registration => {  
      function showUpdatePopup() {  
        const box = document.createElement('div');  
        box.innerHTML = "🆕 New version available — <b>Tap to update</b>";  
        box.style.cssText = `  
          position: fixed;  
          bottom: 90px;  
          left: 50%;  
          transform: translateX(-50%);  
          background: linear-gradient(45deg, #0af, #0f5);  
          color: white;  
          padding: 12px 20px;  
          border-radius: 25px;  
          font-weight: bold;  
          box-shadow: 0 5px 15px rgba(0,0,0,0.3);  
          z-index: 9999;  
          cursor: pointer;  
          animation: slideUp 0.3s ease;
        `;  
        box.onclick = () => {  
          box.remove();  
          if (registration.waiting) {  
            registration.waiting.postMessage({ action: "skipWaiting" });  
          }  
        };  
        document.body.appendChild(box);  
      }  

      function listenForWaitingSW(reg) {  
        if (!reg) return;  
        if (reg.waiting) return showUpdatePopup();  

        if (reg.installing) {  
          reg.installing.addEventListener("statechange", function () {  
            if (this.state === "installed" && navigator.serviceWorker.controller) {  
              showUpdatePopup();  
            }  
          });  
        }  

        reg.addEventListener("updatefound", () => {  
          if (reg.installing) {  
            reg.installing.addEventListener("statechange", function () {  
              if (this.state === "installed" && navigator.serviceWorker.controller) {  
                showUpdatePopup();  
              }  
            });  
          }  
        });  
      }  

      listenForWaitingSW(registration);  
    });  

    navigator.serviceWorker.addEventListener("controllerchange", () => {  
      window.location.reload();  
    });  
  }

  // Push Notification Setup
  function setupPushNotifications() {
    if ('Notification' in window && 'serviceWorker' in navigator) {
      Notification.requestPermission().then(permission => {
        if (permission === 'granted') {
          showNotification('Push notifications enabled!', 'success');
        }
      });
    }
  }

  // Initialize App
  function initializeApp() {
    // Load saved settings
    applyTheme();
    updateLanguage();
    
    // Set language selector
    document.getElementById('languageSelect').value = currentLanguage;
    
    // Show telegram popup after delay
    const alreadyClosed = localStorage.getItem('hideTelegramPopup');
    if (!alreadyClosed) {
      setTimeout(() => {
        document.getElementById('telegramPopup').style.display = 'block';
      }, 5000);
    }
    
    // Setup push notifications
    setupPushNotifications();
    
    // Load initial data
    fetchMatches();
    
    // Start auto refresh
    startAutoRefresh();
    
    // Show live category by default
    showCategory('live');
    
    // Welcome notification
    setTimeout(() => {
      showNotification('Welcome to CricStreamZone! 🏏', 'success');
    }, 1000);
  }

  // Keyboard Shortcuts
  document.addEventListener('keydown', function(e) {
    // Ctrl/Cmd + K for search focus
    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
      e.preventDefault();
      document.getElementById('search').focus();
    }
    
    // Escape to close drawer
    if (e.key === 'Escape') {
      const drawer = document.getElementById('drawer');
      if (drawer.classList.contains('open')) {
        toggleDrawer();
      }
    }
    
    // Arrow keys for tab navigation
    if (document.getElementById('subTabs').style.display === 'block') {
      if (e.key === 'ArrowLeft') {
        const subTabs = ['live', 'today', 'upcoming'];
        const currentIndex = subTabs.indexOf(currentSubTab);
        if (currentIndex > 0) {
          const newTab = subTabs[currentIndex - 1];
          currentSubTab = newTab;
          setActiveSubTab(currentSubTab);
          renderMatches(currentSubTab);
        }
      } else if (e.key === 'ArrowRight') {
        const subTabs = ['live', 'today', 'upcoming'];
        const currentIndex = subTabs.indexOf(currentSubTab);
        if (currentIndex < subTabs.length - 1) {
          const newTab = subTabs[currentIndex + 1];
          currentSubTab = newTab;
          setActiveSubTab(currentSubTab);
          renderMatches(currentSubTab);
        }
      }
    }
  });

  // Performance Optimization
  function optimizePerformance() {
    // Lazy loading for images
    const images = document.querySelectorAll('img[loading="lazy"]');
    if ('IntersectionObserver' in window) {
      const imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const img = entry.target;
            img.src = img.dataset.src || img.src;
            img.classList.remove('lazy');
            observer.unobserve(img);
          }
        });
      });
      
      images.forEach(img => imageObserver.observe(img));
    }
    
    // Debounce search input
    let searchTimeout;
    document.getElementById('search').addEventListener('input', function() {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        if(document.getElementById('subTabs').style.display === 'block'){
          renderMatches(currentSubTab);
        }
      }, 300);
    });
  }

  // Error Handling
  window.addEventListener('error', function(e) {
    console.error('Global error:', e.error);
    showNotification('An error occurred. Please refresh the page.', 'error');
  });

  window.addEventListener('unhandledrejection', function(e) {
    console.error('Unhandled promise rejection:', e.reason);
    showNotification('Network error. Please check your connection.', 'error');
  });

  // Offline Detection
  window.addEventListener('online', function() {
    showNotification('Connection restored! 🌐', 'success');
    fetchMatches();
  });

  window.addEventListener('offline', function() {
    showNotification('You are offline. Some features may not work.', 'error');
  });

  // Analytics and User Tracking (Privacy-friendly)
  function trackUserInteraction(action, category = 'user') {
    // Simple analytics without personal data
    const analytics = JSON.parse(localStorage.getItem('analytics')) || {};
    const today = new Date().toDateString();
    
    if (!analytics[today]) {
      analytics[today] = {};
    }
    
    if (!analytics[today][category]) {
      analytics[today][category] = {};
    }
    
    analytics[today][category][action] = (analytics[today][category][action] || 0) + 1;
    
    localStorage.setItem('analytics', JSON.stringify(analytics));
  }

  // Add click tracking to important elements
  document.addEventListener('click', function(e) {
    if (e.target.matches('.server-buttons a')) {
      trackUserInteraction('server_click', 'streaming');
    } else if (e.target.matches('.favorite-btn')) {
      trackUserInteraction('favorite_toggle', 'engagement');
    } else if (e.target.matches('.bottom-tab-btns button')) {
      trackUserInteraction('tab_switch', 'navigation');
    }
  });

  // Memory Management
  function cleanupMemory() {
    // Clear old intervals
    clearIntervals();
    
    // Remove old analytics data (keep only last 7 days)
    const analytics = JSON.parse(localStorage.getItem('analytics')) || {};
    const sevenDaysAgo = new Date();
    sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
    
    Object.keys(analytics).forEach(date => {
      if (new Date(date) < sevenDaysAgo) {
        delete analytics[date];
      }
    });
    
    localStorage.setItem('analytics', JSON.stringify(analytics));
  }

  // Cleanup memory every 30 minutes
  setInterval(cleanupMemory, 30 * 60 * 1000);

  // Enhanced Search with Suggestions
  function setupSearchSuggestions() {
    const searchInput = document.getElementById('search');
    const suggestionsContainer = document.createElement('div');
    suggestionsContainer.style.cssText = `
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: rgba(34, 34, 34, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 0 0 10px 10px;
      max-height: 200px;
      overflow-y: auto;
      z-index: 1000;
      display: none;
    `;
    
    searchInput.parentElement.style.position = 'relative';
    searchInput.parentElement.appendChild(suggestionsContainer);
    
    searchInput.addEventListener('input', function() {
      const query = this.value.toLowerCase().trim();
      
      if (query.length < 2) {
        suggestionsContainer.style.display = 'none';
        return;
      }
      
      const suggestions = [];
      matches.forEach(match => {
        if (match.Team1.toLowerCase().includes(query)) suggestions.push(match.Team1);
        if (match.Team2.toLowerCase().includes(query)) suggestions.push(match.Team2);
        if (match.Match.toLowerCase().includes(query)) suggestions.push(match.Match);
      });
      
      const uniqueSuggestions = [...new Set(suggestions)].slice(0, 5);
      
      if (uniqueSuggestions.length > 0) {
        suggestionsContainer.innerHTML = uniqueSuggestions.map(suggestion => 
          `<div style="padding: 10px; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.1);" onclick="selectSuggestion('${suggestion}')">${suggestion}</div>`
        ).join('');
        suggestionsContainer.style.display = 'block';
      } else {
        suggestionsContainer.style.display = 'none';
      }
    });
    
    // Hide suggestions when clicking outside
    document.addEventListener('click', function(e) {
      if (!searchInput.parentElement.contains(e.target)) {
        suggestionsContainer.style.display = 'none';
      }
    });
  }

  function selectSuggestion(suggestion) {
    document.getElementById('search').value = suggestion;
    document.querySelector('.search-container div').style.display = 'none';
    renderMatches(currentSubTab);
  }

  // App Rating System
  function showRatingPrompt() {
    const lastPrompt = localStorage.getItem('lastRatingPrompt');
    const now = Date.now();
    
    // Show rating prompt every 7 days
    if (!lastPrompt || (now - parseInt(lastPrompt)) > 7 * 24 * 60 * 60 * 1000) {
      setTimeout(() => {
        const rating = confirm('Are you enjoying CricStreamZone? Would you like to rate us?');
        if (rating) {
          window.open('https://play.google.com/store/apps/details?id=com.cricstreamzone', '_blank');
        }
        localStorage.setItem('lastRatingPrompt', now.toString());
      }, 10000);
    }
  }

  // Initialize everything when DOM is loaded
  document.addEventListener('DOMContentLoaded', function() {
    initializeApp();
    optimizePerformance();
    setupSearchSuggestions();
    showRatingPrompt();
    
    // Add some CSS animations
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideUp {
        from { transform: translateX(-50%) translateY(100px); opacity: 0; }
        to { transform: translateX(-50%) translateY(0); opacity: 1; }
      }
      
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      .match {
        animation: fadeIn 0.5s ease forwards;
      }
      
      .match:nth-child(even) {
        animation-delay: 0.1s;
      }
      
      .match:nth-child(odd) {
        animation-delay: 0.2s;
      }
      
      /* Scrollbar Styling */
      ::-webkit-scrollbar {
        width: 8px;
      }
      
      ::-webkit-scrollbar-track {
        background: rgba(255,255,255,0.1);
        border-radius: 10px;
      }
      
      ::-webkit-scrollbar-thumb {
        background: linear-gradient(45deg, #0af, #0f5);
        border-radius: 10px;
      }
      
      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(45deg, #08d, #0d4);
      }
      
      /* Loading Animation */
      .loading-text {
        background: linear-gradient(45deg, #0af, #0f5, #0af);
        background-size: 200% 200%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        animation: gradientPulse 2s ease infinite;
      }
      
      /* Responsive Improvements */
      @media (max-width: 480px) {
        .teams-section {
          padding: 0 5px;
        }
        
        .team img {
          width: 28px;
          height: 28px;
        }
        
        .team-name {
          font-size: 11px;
        }
        
        .server-buttons a {
          padding: 5px 8px;
          font-size: 10px;
        }
        
        .match-title {
          font-size: 12px;
          padding: 4px 8px;
        }
      }
    `;
    document.head.appendChild(style);
  });

  // Export functions for global access
  window.toggleDrawer = toggleDrawer;
  window.showCategory = showCategory;
  window.toggleFavorite = toggleFavorite;
  window.showFavorites = showFavorites;
  window.showSettings = showSettings;
  window.saveSettings = saveSettings;
  window.toggleTheme = toggleTheme;
  window.changeLanguage = changeLanguage;
  window.shareApp = shareApp;
  window.startVoiceSearch = startVoiceSearch;
  window.toggleAdvancedSearch = toggleAdvancedSearch;
  window.applyFilters = applyFilters;
  window.toggleFilterSection = toggleFilterSection;
  window.closeTelegramPopup = closeTelegramPopup;
  window.selectSuggestion = selectSuggestion;

</script>  
</body>  
</html>
